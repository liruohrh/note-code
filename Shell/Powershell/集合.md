# è‡ªåŠ¨ææƒç®¡ç†å‘˜
```powershell
# 1. æ£€æµ‹å½“å‰æ˜¯å¦ä¸ºç®¡ç†å‘˜æƒé™
$currentPrincipal = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
$isAdmin = $currentPrincipal.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
  
# 2. éç®¡ç†å‘˜åˆ™è‡ªåŠ¨ææƒé‡å¯è„šæœ¬
if (-not $isAdmin) {
Â  Â  # æ„å»ºææƒå¯åŠ¨å‚æ•°ï¼š-NoProfileï¼ˆä¸åŠ è½½ç”¨æˆ·é…ç½®ï¼‰ã€-ExecutionPolicy Bypassï¼ˆç»•è¿‡æ‰§è¡Œç­–ç•¥ï¼‰ã€-Fileï¼ˆæŒ‡å®šè¿è¡Œè„šæœ¬æ–‡ä»¶ï¼‰
Â  Â  $arguments = "-NoProfile -ExecutionPolicy Bypass -File `"$($MyInvocation.MyCommand.Definition)`""
Â  Â  # åˆ›å»ºç®¡ç†å‘˜æƒé™çš„è¿›ç¨‹å¯åŠ¨ä¿¡æ¯
Â  Â  $processStartInfo = New-Object System.Diagnostics.ProcessStartInfo
Â  Â  $processStartInfo.FileName = "powershell.exe"
Â  Â  $processStartInfo.Arguments = $arguments
Â  Â  $processStartInfo.Verb = "runas" Â # å…³é”®ï¼šæŒ‡å®šä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
Â  Â  $processStartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Normal
Â  Â  try {
Â  Â  Â  Â  # å¯åŠ¨ææƒè¿›ç¨‹ï¼Œä¼šå¼¹å‡ºUACç”¨æˆ·è´¦æˆ·æ§åˆ¶å¼¹çª—
Â  Â  Â  Â  [System.Diagnostics.Process]::Start($processStartInfo) | Out-Null
Â  Â  }
Â  Â  catch {
Â  Â  Â  Â  Write-Host "âŒ ææƒå¤±è´¥ï¼ä½ æ‹’ç»äº†ç®¡ç†å‘˜æƒé™è¯·æ±‚ï¼Œè„šæœ¬æ— æ³•æ‰§è¡Œã€‚" -ForegroundColor Red
Â  Â  Â  Â  Pause
Â  Â  Â  Â  exit 1
Â  Â  }
Â  Â  # åŸéç®¡ç†å‘˜è¿›ç¨‹é€€å‡ºï¼Œä»…ä¿ç•™ææƒåçš„æ–°è¿›ç¨‹
Â  Â  exit 0
}
# 3. ç®¡ç†å‘˜æƒé™ä¸‹æ‰§è¡ŒåŸæœ‰æ ¸å¿ƒåŠŸèƒ½
Write-Host "ğŸ”‘ å·²è·å–ç®¡ç†å‘˜æƒé™ï¼Œè„šæœ¬æ­£å¸¸æ‰§è¡Œ..." -ForegroundColor Green

```

# å®æ—¶å…³é—­windowså®æ—¶ä¿æŠ¤

```powershell

$isAdmin = ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
if (-not $isAdmin) {
    Write-Host "âš ï¸ è¯·ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œæ­¤è„šæœ¬ï¼" -ForegroundColor Red
    Pause
    exit
}

Write-Host "ğŸ” å¼€å§‹æ¯ 5 ç§’å…³é—­ä¸€æ¬¡ Windows Defender å®æ—¶ä¿æŠ¤..." -ForegroundColor Cyan

while ($true) {
    try {
        Set-MpPreference -DisableRealtimeMonitoring $true -ErrorAction Stop
        Write-Host "$(Get-Date -Format 'HH:mm:ss') - å®æ—¶ä¿æŠ¤å·²å…³é—­ã€‚"
    }
    catch {
        Write-Host "$(Get-Date -Format 'HH:mm:ss') - å…³é—­å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Yellow
    }

    Start-Sleep -Seconds 5
}

<# æ‰“å¼€ï¼š

Set-MpPreference -DisableRealtimeMonitoring $false 

#>

```